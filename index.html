<title>Web Clapping</title>

<body>
	<h1>press any key</h1>
	<div id="member"></div>
</body>
<script src="/socket.io/socket.io.js"></script>
<script>
	var socket = io.connect();
	socket.on('clap', function (data) {
		getAudio("clap").play();
	});
	var div = document.getElementById("member");
	socket.on('member', function(member){
		div.textContent = member+"人なう";
	});
	document.body.addEventListener("keydown", function(){
		socket.emit("clap");
	});

	function getAudio(filename){
		var audio;
		try  {
			audio = new Audio();
			audio.removeAttribute("src");
			["ogg", "mp3", "wav"].forEach(function (ext) {
				var source = document.createElement("source");
				source.src = filename + "." + ext;
				source.type = "audio/" + ext;
				audio.appendChild(source);
			});
		} catch (e) {
			audio = { play: function () {} };
		}
		return audio;
	}

</script>

